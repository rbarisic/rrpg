# def initialize(window, entities: [])

start_menu = RRPG::State.new($window)

map = RRPG::Entity::Map.new('./data/tilesets/default.png',
    [
        [2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2],
        [2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2],
        [2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2],
        [2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2],
        [2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2],
        [2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2],
        [2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2],
        [2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2],
        [2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2],
        [2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2],
        [2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2],
        [2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2],
        [2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2],
        [2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2],
        [2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2],
        [2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2],
        [2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2],
        [2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2],
        [2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2],
        [2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2],
        [2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2],
        [2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2],
        [2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2],
        [2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2],
        [2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2],
        [2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2],
        [2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2],
        [2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2],
        [2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2],
    ],
    actors: [
        { name: "Jorgan", x: 32, y: 32 },
        # { name: "Heidbrun", x: 32, y: 64 },
        # { name: "Heidbrun", x: 64, y: 64 },
        # { name: "Heidbrun", x: 96, y: 64 },
        # { name: "Heidbrun", x: 128, y: 96 },
        # { name: "Heidbrun", x: 128, y: 64 },
        # { name: "Heidbrun", x: 96, y: 128 },
    ]
)

start_menu.add_entity(map)

start_menu.cam.focus = start_menu.entities.first.entities.first

$window.states[:start_menu] = start_menu

#     start_menu: State.new(
#         self,
#         entities: [
#             Entity::UI::Menu.new(
#                 32,64,20,
#                 menu_entries: [
#                     Entity::UI::MenuEntry.new('New Game', proc { System.state_update(:new_game) }),
#                     Entity::UI::MenuEntry.new('Load Game', proc { System.state_update(:start_menu) }),
#                     Entity::UI::MenuEntry.new('Map Editor',
#                         proc { 
#                             state = create_state(
#                                 State.new(self, entities: [
#                                     Entity::Map.new('./data/tilesets/default.png',
#                                         [
#                                             [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
#                                             [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
#                                             [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
#                                             [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
#                                             [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
#                                             [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
#                                             [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
#                                             [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
#                                             [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
#                                             [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
#                                             [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
#                                             [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
#                                             [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
#                                         ]),
#                                         Entity::UI::EditorTilePicker.new(16, 16,1000)
#                                     ]
#                                 ),
#                             )
#                             @state = state
#                         }),
#                     Entity::UI::MenuEntry.new('Exit', proc { System.exit_game })
#                 ]
#             )
#         ]
#     ),
#     new_game: State.new(
#         self,
#         entities: [
#             Entity::Map.new('./data/tilesets/default.png',
#                 [
#                     [0,3,3,3,3,4,1,2,3,4,2,3,1,2,3,4,1,2,3,5,],
#                     [0,1,1,1,4,4,1,2,3,4,2,3,1,2,3,4,1,2,3,5,],
#                     [0,1,2,2,1,4,1,2,3,4,2,3,1,2,3,4,1,2,3,5,],
#                     [0,1,2,2,1,0,1,2,3,4,2,3,1,2,3,4,1,2,3,5,],
#                     [0,1,1,1,1,0,1,2,3,4,2,3,1,2,3,4,1,2,3,5,],
#                     [0,0,0,2,0,0,1,2,3,4,2,3,1,2,3,4,1,2,3,5,],
#                     [0,0,0,2,2,0,1,2,3,4,2,3,1,2,3,4,1,2,3,5,],
#                     [0,0,0,2,0,0,1,2,3,4,2,3,1,2,3,4,1,2,3,5,],
#                     [0,0,0,2,0,0,1,2,3,4,2,3,1,2,3,4,1,2,3,5,],
#                     [0,0,0,2,0,0,1,2,3,4,2,3,1,2,3,4,1,2,3,5,],
#                     [0,0,0,2,0,0,1,2,3,4,2,3,1,2,3,4,1,2,3,5,],
#                     [0,0,0,2,0,0,1,2,3,4,2,3,1,2,3,4,1,2,3,5,],
#                     [0,0,0,2,0,0,1,2,3,4,2,3,1,2,3,4,1,2,3,5,],
#                     [0,0,0,2,0,0,1,2,3,4,2,3,1,2,3,4,1,2,3,5,],
#                     [0,0,0,2,0,0,1,2,3,4,2,3,1,2,3,4,1,2,3,5,],
#                     [0,0,0,2,0,0,1,2,3,4,2,3,1,2,3,4,1,2,3,5,],
#                     [0,0,0,2,0,0,1,2,3,4,2,3,1,2,3,4,1,2,3,5,],
#                     [0,0,0,2,0,0,1,2,3,4,2,3,1,2,3,4,1,2,3,5,],
#                     [0,0,0,2,0,0,1,2,3,4,2,3,1,2,3,4,1,2,3,5,],
#                     [0,0,0,2,0,0,1,2,3,4,2,3,1,2,3,4,1,2,3,5,],
#                     [0,0,0,2,0,0,1,2,3,4,2,3,1,2,3,4,1,2,3,5,],
#                     [0,0,0,2,0,0,1,2,3,4,2,3,1,2,3,4,1,2,3,5,],
#                     [0,0,0,2,0,0,1,2,3,4,2,3,1,2,3,4,1,2,3,5,],
#                     [0,0,0,2,0,0,1,2,3,4,2,3,1,2,3,4,1,2,3,5,],
#                     [0,0,0,2,0,0,1,2,3,4,2,3,1,2,3,4,1,2,3,5,],
#                     [0,0,0,2,0,0,1,2,3,4,2,3,1,2,3,4,1,2,3,5,],
#                     [0,0,0,2,0,0,1,2,3,4,2,3,1,2,3,4,1,2,3,5,],
#                     [0,0,0,2,0,0,1,2,3,4,2,3,1,2,3,4,1,2,3,5,],
#                     [0,0,0,2,0,0,1,2,3,4,2,3,1,2,3,4,1,2,3,5,],
#                     [0,0,0,2,0,0,1,2,3,4,2,3,1,2,3,4,1,2,3,5,],
#                     [0,0,0,2,0,0,1,2,3,4,2,3,1,2,3,4,1,2,3,5,],
#                 ],
#                 actors: [
#                     {
#                         name: "Gustaf",
#                         x: 32,
#                         y: 32
#                     },
#                     {
#                         name: "Peter",
#                         x: 96,
#                         y: 32
#                     } 
#                 ]
#             )
#         ] # end entities
#     )
# }